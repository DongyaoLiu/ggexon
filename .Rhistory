shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2)
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
track_data = add_transcripts_seq_line(data)
track_data$linewidth = 1
transcripts_line_Grob = GeomSegment$draw_panel(track_data, panel_params, coord)
tri_data = add_transcripts_direction(track_data)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
transcripts_line_Grob,
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
load_all()
load_all()
load_all()
load_all()
load_all()
geom_exon2()
library(available)
available("ggexon")
library(devtools)
load_all()
load_all()
library(devtools)
add_transcripts_direction
add_transcripts_direction()
load_all()
library(devtools)
load_all()
load_all()
library(ggforce)
getSplines()
ggforce::getSplines()
load_all()
GeomGene <- ggproto("GeomGene", Geom,
required_aes = c("ymin", "xmin", "xmax", "transcripts","strand", "track"),
non_missing_aes = c("linewidth", "shape"),
extra_params = c("exon_height", "na.rm", "y_scale", "x_translation", "proportion_trim3"),
default_aes = aes(linewidth = 0, linejoin = "mitre", fill="black",
colour = NULL,
size = 15,
linetype = 1,
shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2) %>%
group_by(transcripts) %>% mutate(xmin = min(xmin),
xmax = max(xmax))  %>% slice(1)
mutate(xmax = if_else(strand == "+", xmax - xmax * params$proportion_trim3, xmax),
xmin = if_else(strand == "-", xmin + xmin * params$proportion_trim3, xmin))
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
print(data)
track_data = add_transcripts_seq_line(data, transcripts_stop_length = NULL, transcripts_stop_proportion = 0.2)
tri_data = add_transcripts_direction(track_data, ratio = 1, angle = pi/3, length = 0)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
install.packages("ggridges")
install.packages("sloop")
library(sloop)
class(print())
class(print
)
s3_get_method(print)
class(t.test)
ftype(t.test)
ftype(t.data.frame)
t.test
t.data.frame
?structure()
stopifnot
library(methods)
install.packages("seqinr")
library(seqinr)
read.fasta(file = system.file("sequences/ct.fasta.gz", package = "seqinr"))
type(read.fasta(file = system.file("sequences/ct.fasta.gz", package = "seqinr"))
)
typeof(read.fasta(file = system.file("sequences/ct.fasta.gz", package = "seqinr")))
class(read.fasta(file = system.file("sequences/ct.fasta.gz", package = "seqinr")))
?setClass
cli::ansi_align()
??cli
GeomExon <- ggproto("GeomExon", Geom,
required_aes = c("ymin", "xmin", "xmax", "transcripts","strand", "track", "type"),
non_missing_aes = c("linewidth", "shape"),
extra_params = c("exon_height", "na.rm", "x_translation", "subset", "annotation_type"),
default_aes = aes(linewidth = 0, linejoin = "mitre", fill="black",
colour = NULL,
size = 15,
linetype = 1,
shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
if (!is.null(params$annotation_type)){
data = data %>% filter(type == params$annotation_type)
}
if (!is.null(params$subset)) {
print(params$subset)
#' filter base on the subset region.
data = data %>% filter(start >= subset[1], end <= subset[2])
}
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2)
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
track_data = add_transcripts_seq_line(data)
track_data$linewidth = 1
transcripts_line_Grob = GeomSegment$draw_panel(track_data, panel_params, coord)
tri_data = add_transcripts_direction(track_data)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
transcripts_line_Grob,
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
GeomExon <- ggproto("GeomExon", Geom,
required_aes = c("ymin", "xmin", "xmax", "transcripts","strand", "track", "type"),
non_missing_aes = c("linewidth", "shape"),
extra_params = c("exon_height", "na.rm", "x_translation", "subset", "annotation_type"),
default_aes = aes(linewidth = 0, linejoin = "mitre", fill="black",
colour = NULL,
size = 15,
linetype = 1,
shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
if (!is.null(params$annotation_type)){
data = data %>% filter(type == params$annotation_type)
}
if (!is.null(params$subset)) {
print(params$subset)
start1 = subset[1]
end1 = subset[2]
#' filter base on the subset region.
data = data %>% filter(start >= start1, end <= end1)
}
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2)
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
track_data = add_transcripts_seq_line(data)
track_data$linewidth = 1
transcripts_line_Grob = GeomSegment$draw_panel(track_data, panel_params, coord)
tri_data = add_transcripts_direction(track_data)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
transcripts_line_Grob,
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
GeomExon <- ggproto("GeomExon", Geom,
required_aes = c("ymin", "xmin", "xmax", "transcripts","strand", "track", "type"),
non_missing_aes = c("linewidth", "shape"),
extra_params = c("exon_height", "na.rm", "x_translation", "subset", "annotation_type"),
default_aes = aes(linewidth = 0, linejoin = "mitre", fill="black",
colour = NULL,
size = 15,
linetype = 1,
shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
if (!is.null(params$annotation_type)){
data = data %>% filter(type == params$annotation_type)
}
if (!is.null(params$subset)) {
#' filter base on the subset region.
data = data %>% filter(start >= params$subset()[1], end <= params$subset()[2])
}
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2)
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
track_data = add_transcripts_seq_line(data)
track_data$linewidth = 1
transcripts_line_Grob = GeomSegment$draw_panel(track_data, panel_params, coord)
tri_data = add_transcripts_direction(track_data)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
transcripts_line_Grob,
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
GeomExon <- ggproto("GeomExon", Geom,
required_aes = c("ymin", "xmin", "xmax", "transcripts","strand", "track", "type"),
non_missing_aes = c("linewidth", "shape"),
extra_params = c("exon_height", "na.rm", "x_translation", "subset", "annotation_type"),
default_aes = aes(linewidth = 0, linejoin = "mitre", fill="black",
colour = NULL,
size = 15,
linetype = 1,
shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
if (!is.null(params$annotation_type)){
data = data %>% filter(type == params$annotation_type)
}
if (!is.null(params$subset)) {
#' filter base on the subset region.
print(params$subset())
data = data %>% filter(start >= params$subset()[1], end <= params$subset()[2])
}
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2)
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
track_data = add_transcripts_seq_line(data)
track_data$linewidth = 1
transcripts_line_Grob = GeomSegment$draw_panel(track_data, panel_params, coord)
tri_data = add_transcripts_direction(track_data)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
transcripts_line_Grob,
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
GeomExon <- ggproto("GeomExon", Geom,
required_aes = c("ymin", "xmin", "xmax", "transcripts","strand", "track", "type"),
non_missing_aes = c("linewidth", "shape"),
extra_params = c("exon_height", "na.rm", "x_translation", "subset", "annotation_type"),
default_aes = aes(linewidth = 0, linejoin = "mitre", fill="black",
colour = NULL,
size = 15,
linetype = 1,
shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
if (!is.null(params$annotation_type)){
data = data %>% filter(type == params$annotation_type)
}
if (!is.null(params$subset)) {
#' filter base on the subset region.
print(typeof(params$subset))
print(typeof(params$subset[1]))
start1 = int(params$subset[1])
end1 = int(params$subset[2])
data = data %>% filter(start >= start1, end <= end1)
}
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2)
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
track_data = add_transcripts_seq_line(data)
track_data$linewidth = 1
transcripts_line_Grob = GeomSegment$draw_panel(track_data, panel_params, coord)
tri_data = add_transcripts_direction(track_data)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
transcripts_line_Grob,
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
GeomExon <- ggproto("GeomExon", Geom,
required_aes = c("ymin", "xmin", "xmax", "transcripts","strand", "track", "type"),
non_missing_aes = c("linewidth", "shape"),
extra_params = c("exon_height", "na.rm", "x_translation", "subset", "annotation_type"),
default_aes = aes(linewidth = 0, linejoin = "mitre", fill="black",
colour = NULL,
size = 15,
linetype = 1,
shape = 19,
alpha = NA,
stroke = 1
),
setup_data = function(data, params){
if (!is.null(params$annotation_type)){
data = data %>% filter(type == params$annotation_type)
}
if (!is.null(params$subset)) {
#' filter base on the subset region.
print(typeof(params$subset))
print(typeof(params$subset[1]))
start1 = int(params$subset[1])
end1 = int(params$subset[2])
print(start1)
print(typeof(start1))
data = data %>% filter(xmin >= start1, xmax <= end1)
}
data = data %>% group_by(track) %>%
mutate(xmin2 = min(xmin)) %>%
mutate(x_adjustment = 0) %>%
mutate(xmin = xmin - xmin2, xmax = xmax - xmin2)
if (params$x_translation!=0){
data = data %>% mutate(xmin = xmin + params$x_translation, xmax =xmax + params$x_translation)
}
rec_data = seq_add_y(data = data,
track_proportion = params$transcripts_track_ratio,
y_scale = params$y_scale,
exon_proportion = 0.8, blank_proportion = 0.2,
sandwich_ratio = params$sandwich_ratio,
exon_height = params$exon_height)
},
draw_panel = function(data, panel_params, coord, flipped_aes = FALSE){
track_data = add_transcripts_seq_line(data)
track_data$linewidth = 1
transcripts_line_Grob = GeomSegment$draw_panel(track_data, panel_params, coord)
tri_data = add_transcripts_direction(track_data)
tri_data$linewidth = 0
transcripts_tri_Grob = GeomPolygon$draw_panel(tri_data, panel_params, coord)
ggname("geom_exon", gTree(children = gList(
transcripts_line_Grob,
GeomRect$draw_panel(data, panel_params, coord),
transcripts_tri_Grob
)
)
)
},
draw_key = draw_key_polygon
)
?do.call()
elif
elif()
ls("./R")
ls("./R/")
list.files("./R/")
library(cli)
?list
GeomRect$draw_panel
GeomRect$draw_panel()
getAnywhere("GeomRect")
library(devtools)
?fuzzy_left_join
??fuzzy_left_join
GeomRect
ggplot2::ggplot
?attach_plot_env
attach_plot_env
attach_plot_env
list(XZ1516 = c(200, 800))
list(XZ1516 = c(200, 800), XZ1516 = c(200, 900))
library(tidyverse)
?tibble()
list(XZ1516 = tibble(start = 50, end = 100))
list(XZ1516 = tibble(start = c(50,100), end = c(100, 200))
)
list(XZ1516 = tibble(start = c(50,100), end = c(100, 200)))
unique()
tibble(start = c(50,100), end = c(100, 200))
tibble(start = c(50,100), end = c(100, 200), .rows = c(rep(XZ1516, 2)))
tibble(start = c(50,100), end = c(100, 200), .rows = c(rep("XZ1516", 2)))
tibble(start = c(50,100), end = c(100, 200), .rows = c(2, 2))
tibble(start = c(50,100), end = c(100, 200), .rows = c(2))
tibble(start = c(50,100), end = c(100, 200), .rows = 1)
?tibble
?data.frame
data_frame(start = c(50,100), end = c(100, 200), .rows = 1)
data.frame(start = c(50,100), end = c(100, 200), .rows = 1)
data.frame(start = c(50,100), end = c(100, 200))
data.frame(start = c(50,100), end = c(100, 200), row.names = c(rep(XZ1516, 2)))
data.frame(start = c(50,100), end = c(100, 200), row.names = c(rep("XZ1516"", 2)))
)
)
data.frame(start = c(50,100), end = c(100, 200), row.names = c(rep("XZ1516"", 2)))
data.frame(start = c(50,100), end = c(100, 200), row.names = c(rep("XZ1516", 2)))
data.frame(start = c(50,100), end = c(100, 200), row.names = c(rep("XZ1516", "DL")))
?inner_join
?scales::trans_new
?waiver
?caller_call
scales::rescale()
??scales
?scales::trans_new()
?transform_log10
transform_log10
scales::transform_log10
transform_log
scales::transform_log
?structure
?ggproto
p_value <- prop_test$p.value
ggexon()+geom(data = mtcars, aes(x = ))
